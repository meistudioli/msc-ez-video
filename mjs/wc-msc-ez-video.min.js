import{_wcl}from"./common-lib.js";import{_wccss}from"./common-css.js";const defaults={width:16,height:9,src:"",poster:"",muted:!1,autoplay:!1,controls:!1,loop:!1,loopendtime:NaN,crossorigin:"anonymous",title:"unknown title",artist:"unknown artist"},booleanAttrs=["muted","autoplay","controls","loop"],objectAttrs=[],custumEvents={loaded:"ez-video-loadeddata",play:"ez-video-play",pause:"ez-video-pause",seek:"ez-video-seek",timeupdate:"ez-video-timeupdate",mute:"ez-video-mutechange",fullscreen:"ez-video-fullscreenchange",PiP:"ez-video-PiPchange",rate:"ez-video-ratechange",error:"ez-video-error"},legalKey=["Escape","k","m","i","f"," ","j","l","<",">","0","1","2","3","4","5","6","7","8","9","ArrowLeft","ArrowRight"],maxPlaybackRate=2,minPlaybackRate=.25,fullscreen=_wcl.isFullscreenSupport(),PiP=_wcl.isPiPSupport(),mediaSession=_wcl.isAPISupport("mediaSession",navigator),getAllEzVideo=()=>Array.from(document.querySelectorAll(_wcl.classToTagName("MscEzVideo"))),mediaTrackAction=(e,t="previous",a=getAllEzVideo())=>{e=(a.indexOf(e)+("previous"===t?-1:1)+a.length)%a.length,t=a[e],a=_wcl.classToTagName("MscEzVideo");Array.from(document.querySelectorAll(a+",video,audio")).forEach(e=>e.pause()),t.scrollIntoView({behavior:"smooth",block:"center"}),t.play()},template=document.createElement("template"),templateReactionPlay=(template.innerHTML=`
<style>
${_wccss}

:host{position:relative;width:100%;display:block;overflow:hidden;background-color:#000;}
:host {
  --slider-thumb-with: 14px;
  --slider-thumb-color: rgba(255,0,0,1);
  --indicator-background: rgba(255,255,255,.2);
  --indicator-buffer-start: rgba(255,255,255,.4);
  --indicator-buffer-end: rgba(255,255,255,.4);
  --indicator-duration-start: rgba(255,0,0,1);
  --indicator-duration-end: rgba(255,0,0,1);

  --action-height: 36px;
  --action-icon-size: auto 65%;

  --time-text-size: 16px;
  --time-text-color: #fff;

  --warning-font-size: 16px;
  --warning-color: #fff;
  --warning-text: 'Some errors occured. Please try later.';

  --reaction-width: 52px;
  --reaction-bgc-start: rgba(0,0,0,.4);
  --reaction-bgc-end: rgba(0,0,0,.4);

  --ico-play: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScyNCcgaGVpZ2h0PScyNCc+PHBhdGggZmlsbD0nI2ZmZicgZD0nTTggNXYxNGwxMS03eicvPjxwYXRoIGQ9J00wIDBoMjR2MjRIMHonIGZpbGw9J25vbmUnLz48L3N2Zz4=);
  --ico-pause: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScyNCcgaGVpZ2h0PScyNCc+PHBhdGggZmlsbD0nI2ZmZicgZD0nTTYgMTloNFY1SDZ2MTR6bTgtMTR2MTRoNFY1aC00eicvPjxwYXRoIGQ9J00wIDBoMjR2MjRIMHonIGZpbGw9J25vbmUnLz48L3N2Zz4=);
  --ico-mute: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScyNCcgaGVpZ2h0PScyNCc+PHBhdGggZmlsbD0nI2ZmZicgZD0nTTE2LjUgMTJjMC0xLjc3LTEuMDItMy4yOS0yLjUtNC4wM3YyLjIxbDIuNDUgMi40NWMuMDMtLjIuMDUtLjQxLjA1LS42M3ptMi41IDBjMCAuOTQtLjIgMS44Mi0uNTQgMi42NGwxLjUxIDEuNTFDMjAuNjMgMTQuOTEgMjEgMTMuNSAyMSAxMmMwLTQuMjgtMi45OS03Ljg2LTctOC43N3YyLjA2YzIuODkuODYgNSAzLjU0IDUgNi43MXpNNC4yNyAzTDMgNC4yNyA3LjczIDlIM3Y2aDRsNSA1di02LjczbDQuMjUgNC4yNWMtLjY3LjUyLTEuNDIuOTMtMi4yNSAxLjE4djIuMDZjMS4zOC0uMzEgMi42My0uOTUgMy42OS0xLjgxTDE5LjczIDIxIDIxIDE5LjczbC05LTlMNC4yNyAzek0xMiA0TDkuOTEgNi4wOSAxMiA4LjE4VjR6Jy8+PHBhdGggZD0nTTAgMGgyNHYyNEgweicgZmlsbD0nbm9uZScvPjwvc3ZnPg==);
  --ico-unmute: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScyNCcgaGVpZ2h0PScyNCc+PHBhdGggZmlsbD0nI2ZmZicgZD0nTTMgOXY2aDRsNSA1VjRMNyA5SDN6bTEzLjUgM2MwLTEuNzctMS4wMi0zLjI5LTIuNS00LjAzdjguMDVjMS40OC0uNzMgMi41LTIuMjUgMi41LTQuMDJ6TTE0IDMuMjN2Mi4wNmMyLjg5Ljg2IDUgMy41NCA1IDYuNzFzLTIuMTEgNS44NS01IDYuNzF2Mi4wNmM0LjAxLS45MSA3LTQuNDkgNy04Ljc3cy0yLjk5LTcuODYtNy04Ljc3eicvPjxwYXRoIGQ9J00wIDBoMjR2MjRIMHonIGZpbGw9J25vbmUnLz48L3N2Zz4=);
  --ico-fullscreen: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScyNCcgaGVpZ2h0PScyNCc+PHBhdGggZD0nTTAgMGgyNHYyNEgweicgZmlsbD0nbm9uZScvPjxwYXRoIGZpbGw9JyNmZmYnIGQ9J003IDE0SDV2NWg1di0ySDd2LTN6bS0yLTRoMlY3aDNWNUg1djV6bTEyIDdoLTN2Mmg1di01aC0ydjN6TTE0IDV2MmgzdjNoMlY1aC01eicvPjwvc3ZnPg==);
  --ico-fullscreen-exit: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScyNCcgaGVpZ2h0PScyNCc+PHBhdGggZD0nTTAgMGgyNHYyNEgweicgZmlsbD0nbm9uZScvPjxwYXRoIGZpbGw9JyNmZmYnIGQ9J001IDE2aDN2M2gydi01SDV2MnptMy04SDV2Mmg1VjVIOHYzem02IDExaDJ2LTNoM3YtMmgtNXY1em0yLTExVjVoLTJ2NWg1VjhoLTN6Jy8+PC9zdmc+);
  --ico-pip: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScyNCcgaGVpZ2h0PScyNCc+PHBhdGggZmlsbD0nI2ZmZicgZD0nTTE5IDExaC04djZoOHYtNnptNCA4VjQuOThDMjMgMy44OCAyMi4xIDMgMjEgM0gzYy0xLjEgMC0yIC44OC0yIDEuOThWMTljMCAxLjEuOSAyIDIgMmgxOGMxLjEgMCAyLS45IDItMnptLTIgLjAySDNWNC45N2gxOHYxNC4wNXonLz48cGF0aCBmaWxsPSdub25lJyBkPSdNMCAwaDI0djI0SDBWMHonLz48L3N2Zz4=);
  --ico-replay: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScyNCcgaGVpZ2h0PScyNCc+PHBhdGggZD0nTTAgMGgyNHYyNEgweicgZmlsbD0nbm9uZScvPjxwYXRoIGZpbGw9JyNmZmYnIGQ9J00xMiA1VjFMNyA2bDUgNVY3YzMuMzEgMCA2IDIuNjkgNiA2cy0yLjY5IDYtNiA2LTYtMi42OS02LTZINGMwIDQuNDIgMy41OCA4IDggOHM4LTMuNTggOC04LTMuNTgtOC04LTh6Jy8+PC9zdmc+);
  --ico-warning: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScyNCcgaGVpZ2h0PScyNCc+PHBhdGggZD0nTTAgMGgyNHYyNEgweicgZmlsbD0nbm9uZScvPjxwYXRoIGZpbGw9JyNmZmYnIGQ9J00xIDIxaDIyTDEyIDIgMSAyMXptMTItM2gtMnYtMmgydjJ6bTAtNGgtMnYtNGgydjR6Jy8+PC9zdmc+);
  --ico-forward-5: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHhtbG5zOnhsaW5rPSdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rJyB3aWR0aD0nMjQnIGhlaWdodD0nMjQnPjxkZWZzPjxwYXRoIGlkPSdhJyBkPSdNMjQgMjRIMFYwaDI0djI0eicvPjwvZGVmcz48Y2xpcFBhdGggaWQ9J2InPjx1c2UgeGxpbms6aHJlZj0nI2EnIG92ZXJmbG93PSd2aXNpYmxlJy8+PC9jbGlwUGF0aD48cGF0aCBmaWxsPScjZmZmJyBkPSdNNCAxM2MwIDQuNCAzLjYgOCA4IDhzOC0zLjYgOC04aC0yYzAgMy4zLTIuNyA2LTYgNnMtNi0yLjctNi02IDIuNy02IDYtNnY0bDUtNS01LTV2NGMtNC40IDAtOCAzLjYtOCA4em02LjcuOWwuMi0yLjJoMi40di43aC0xLjdsLS4xLjlzLjEgMCAuMS0uMS4xIDAgLjEtLjEuMSAwIC4yIDBoLjJjLjIgMCAuNCAwIC41LjFzLjMuMi40LjMuMi4zLjMuNS4xLjQuMS42YzAgLjIgMCAuNC0uMS41cy0uMS4zLS4zLjUtLjMuMi0uNS4zLS40LjEtLjYuMWMtLjIgMC0uNCAwLS41LS4xcy0uMy0uMS0uNS0uMi0uMi0uMi0uMy0uNC0uMS0uMy0uMS0uNWguOGMwIC4yLjEuMy4yLjRzLjIuMS40LjFjLjEgMCAuMiAwIC4zLS4xbC4yLS4ycy4xLS4yLjEtLjN2LS42bC0uMS0uMi0uMi0uMnMtLjItLjEtLjMtLjFoLS4ycy0uMSAwLS4yLjEtLjEgMC0uMS4xLS4xLjEtLjEuMWgtLjZ6JyBjbGlwLXBhdGg9J3VybCgjYiknLz48L3N2Zz4=);
  --ico-forward-10: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScyNCcgaGVpZ2h0PScyNCc+PHBhdGggZmlsbD0nbm9uZScgZD0nTTAgMGgyNHYyNEgweicvPjxnIGZpbGw9JyNmZmYnPjxwYXRoIGQ9J00xOCAxM2MwIDMuMzEtMi42OSA2LTYgNnMtNi0yLjY5LTYtNiAyLjY5LTYgNi02djRsNS01LTUtNXY0Yy00LjQyIDAtOCAzLjU4LTggOHMzLjU4IDggOCA4IDgtMy41OCA4LThoLTJ6Jy8+PHBhdGggZD0nTTEwLjg2IDE1Ljk0di00LjI3aC0uMDlMOSAxMi4zdi42OWwxLjAxLS4zMXYzLjI2ek0xMi4yNSAxMy40NHYuNzRjMCAxLjkgMS4zMSAxLjgyIDEuNDQgMS44Mi4xNCAwIDEuNDQuMDkgMS40NC0xLjgydi0uNzRjMC0xLjktMS4zMS0xLjgyLTEuNDQtMS44Mi0uMTQgMC0xLjQ0LS4wOS0xLjQ0IDEuODJ6bTIuMDQtLjEydi45N2MwIC43Ny0uMjEgMS4wMy0uNTkgMS4wM3MtLjYtLjI2LS42LTEuMDN2LS45N2MwLS43NS4yMi0xLjAxLjU5LTEuMDEuMzgtLjAxLjYuMjYuNiAxLjAxeicvPjwvZz48L3N2Zz4=);
  --ico-backward-5: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHhtbG5zOnhsaW5rPSdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rJyB3aWR0aD0nMjQnIGhlaWdodD0nMjQnPjxkZWZzPjxwYXRoIGlkPSdhJyBmaWxsPScjZmZmJyBkPSdNMCAwaDI0djI0SDBWMHonLz48L2RlZnM+PGNsaXBQYXRoIGlkPSdiJz48dXNlIHhsaW5rOmhyZWY9JyNhJyBvdmVyZmxvdz0ndmlzaWJsZScvPjwvY2xpcFBhdGg+PHBhdGggZmlsbD0nI2ZmZicgZD0nTTEyIDVWMUw3IDZsNSA1VjdjMy4zIDAgNiAyLjcgNiA2cy0yLjcgNi02IDYtNi0yLjctNi02SDRjMCA0LjQgMy42IDggOCA4czgtMy42IDgtOC0zLjYtOC04LTh6bS0xLjMgOC45bC4yLTIuMmgyLjR2LjdoLTEuN2wtLjEuOXMuMSAwIC4xLS4xLjEgMCAuMS0uMS4xIDAgLjIgMGguMmMuMiAwIC40IDAgLjUuMXMuMy4yLjQuMy4yLjMuMy41LjEuNC4xLjZjMCAuMiAwIC40LS4xLjVzLS4xLjMtLjMuNS0uMy4yLS40LjMtLjQuMS0uNi4xYy0uMiAwLS40IDAtLjUtLjFzLS4zLS4xLS41LS4yLS4yLS4yLS4zLS40LS4xLS4zLS4xLS41aC44YzAgLjIuMS4zLjIuNHMuMi4xLjQuMWMuMSAwIC4yIDAgLjMtLjFsLjItLjJzLjEtLjIuMS0uM3YtLjZsLS4xLS4yLS4yLS4ycy0uMi0uMS0uMy0uMWgtLjJzLS4xIDAtLjIuMS0uMSAwLS4xLjEtLjEuMS0uMS4xaC0uN3onIGNsaXAtcGF0aD0ndXJsKCNiKScvPjwvc3ZnPg==);
  --ico-backward-10: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHhtbG5zOnhsaW5rPSdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rJyB3aWR0aD0nMjQnIGhlaWdodD0nMjQnPjxkZWZzPjxwYXRoIGZpbGw9JyNmZmYnIGlkPSdhJyBkPSdNMCAwaDI0djI0SDBWMHonLz48L2RlZnM+PGNsaXBQYXRoIGlkPSdiJz48dXNlIHhsaW5rOmhyZWY9JyNhJyBvdmVyZmxvdz0ndmlzaWJsZScvPjwvY2xpcFBhdGg+PHBhdGggZmlsbD0nI2ZmZicgZD0nTTEyIDVWMUw3IDZsNSA1VjdjMy4zIDAgNiAyLjcgNiA2cy0yLjcgNi02IDYtNi0yLjctNi02SDRjMCA0LjQgMy42IDggOCA4czgtMy42IDgtOC0zLjYtOC04LTh6bS0xLjEgMTFIMTB2LTMuM0w5IDEzdi0uN2wxLjgtLjZoLjFWMTZ6bTQuMy0xLjhjMCAuMyAwIC42LS4xLjhsLS4zLjZzLS4zLjMtLjUuMy0uNC4xLS42LjEtLjQgMC0uNi0uMS0uMy0uMi0uNS0uMy0uMi0uMy0uMy0uNi0uMS0uNS0uMS0uOHYtLjdjMC0uMyAwLS42LjEtLjhsLjMtLjZzLjMtLjMuNS0uMy40LS4xLjYtLjEuNCAwIC42LjFjLjIuMS4zLjIuNS4zcy4yLjMuMy42LjEuNS4xLjh2Ljd6bS0uOS0uOHYtLjVzLS4xLS4yLS4xLS4zLS4xLS4xLS4yLS4yLS4yLS4xLS4zLS4xLS4yIDAtLjMuMWwtLjIuMnMtLjEuMi0uMS4zdjJzLjEuMi4xLjMuMS4xLjIuMi4yLjEuMy4xLjIgMCAuMy0uMWwuMi0uMnMuMS0uMi4xLS4zdi0xLjV6JyBjbGlwLXBhdGg9J3VybCgjYiknLz48L3N2Zz4=);
  --ico-speed-up-rate: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScyNCcgaGVpZ2h0PScyNCc+PHBhdGggZmlsbD0nI2ZmZicgZD0nTTQgMThsOC41LTZMNCA2djEyem05LTEydjEybDguNS02TDEzIDZ6Jy8+PHBhdGggZmlsbD0nbm9uZScgZD0nTTAgMGgyNHYyNEgweicvPjwvc3ZnPg==);
  --ico-speed-down-rate: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScyNCcgaGVpZ2h0PScyNCc+PHBhdGggZmlsbD0nI2ZmZicgZD0nTTExIDE4VjZsLTguNSA2IDguNSA2em0uNS02bDguNSA2VjZsLTguNSA2eicvPjxwYXRoIGQ9J00wIDBoMjR2MjRIMHonIGZpbGw9J25vbmUnLz48L3N2Zz4=);

  --tip-font-size: 12px;
  --tip-line-height: 1.8;
  --tip-color: #fff;
  --tip-background: rgba(0,0,0,.6);
  --tip-play: 'Play';
  --tip-pause: 'Pause';
  --tip-unmute: 'Unmute';
  --tip-mute: 'Mute';
  --tip-fullscreen: 'Full screen';
  --tip-fullscreen-exit: 'Exit full screen';
  --tip-PiP: 'Picture in Picture';

  --playbackrate-font-size: 18px;
  --playbackrate-line-height: 2;
  --playbackrate-color: #fff;
  --playbackrate-background: rgba(0,0,0,.6);
  --playbackrate-margin-top: calc((var(--reaction-width) * 1.5 / 2 + 3em) * -1);

  --show-always: block;
  --show-on-normal: block;
  --show-on-fullscreen: none;

  --action-play-width: calc(var(--action-height) * 1.27);
  --indicator-height: calc(var(--slider-thumb-with) * .35);
  --action-height-fullscreen: calc(var(--action-height) * 1.33);
  --reaction-width-fullscreen: calc(var(--reaction-width) * 1.33);
  --tip-font-size-fullscreen: calc(var(--tip-font-size) * 1.33);
  --playbackrate-font-size-fullscreen: calc(var(--playbackrate-font-size) * 1.33);

  --tip-y-no-progress: calc(var(--tip-font-size) * var(--tip-line-height) * -1);
  --tip-y-progress: calc((var(--slider-thumb-with) + var(--tip-font-size) * var(--tip-line-height)) * -1);
  --tip-y-fullscreen: calc((var(--slider-thumb-with) + var(--tip-font-size-fullscreen) * var(--tip-line-height)) * -1);
  --tip-y: var(--tip-y-no-progress);
}

:host(:focus){outline:0 none;}
:host(:focus-visible){animation:host-focus 5.7s;}
:host([data-clear-mode]) {
  .control-pannel,
  .reactions {
    visibility: hidden;
  }
}

.main {
  --object-fit: var(--msc-ez-video-object-fit, contain);

  --w: ${defaults.width};
  --h: ${defaults.height};
  --el: 0;
  --eb: 0;
  --control-pannel-lr-padding: calc(var(--slider-thumb-with) + var(--el));
}
.main{position:relative;inline-size:100%;overflow:hidden;aspect-ratio:var(--w)/var(--h);}
.main:focus{outline:0 none;}

video{width:100%;height:100%;display:block;object-fit:var(--object-fit);}

.time-information{font-size:var(--time-text-size);color:var(--time-text-color);line-height:var(--action-height);display:var(--show-on-fullscreen);padding:0 6px;}
.control-pannel{position:absolute;left:0;bottom:0;width:100%;padding:0 var(--control-pannel-lr-padding);box-sizing:border-box;background:linear-gradient(0deg,rgba(0,0,0,.7),transparent 90%);pointer-events:none;user-select:none;-ms-user-select:none;-webkit-user-select:none;}
.vanquish{position:absolute;left:0;top:0;width:0;height:0;overflow:hidden;pointer-events:none;}
.progress-bar-wrap{position:relative;display:var(--show-on-fullscreen);}

.progress-bar-input{position:relative;width:calc(100% + var(--slider-thumb-with));margin-left:calc(var(--slider-thumb-with) / 2 * -1);outline:0 none;border:0 none;-webkit-appearance:none;-moz-appearance:none;appearance:none;outline:none;display:block;background:transparent;z-index:1;pointer-events:auto;}
.progress-bar-input::-webkit-slider-thumb{-webkit-appearance:none;width:var(--slider-thumb-with);height:var(--slider-thumb-with);border-radius:var(--slider-thumb-with);background:var(--slider-thumb-color);border:0 none;cursor:pointer;transition:transform 100ms ease;transform-origin:50% 50%;}
.progress-bar-input:active::-webkit-slider-thumb{transform:scale(1.5);}

.progress-bar-input::-moz-focus-outer{border:0 none;}
.progress-bar-input::-moz-range-thumb{-webkit-appearance:none;width:var(--slider-thumb-with);height:var(--slider-thumb-with);border-radius:var(--slider-thumb-with);background:var(--slider-thumb-color);border:0 none;cursor:pointer;transition:transform 100ms ease;transform-origin:50% 50%;}
.progress-bar-input:active::-moz-range-thumb{transform:scale(1.5);}

.indicators{position:absolute;left:0;top:0;right:0;bottom:0;margin:auto;width:100%;height:var(--indicator-height);border-radius:var(--indicator-height);background:var(--indicator-background);pointer-events:none;overflow:hidden;}
.indicators progress{position:absolute;width:100%;height:100%;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:transparent;border:0 none;display:block;border-radius:var(--indicator-height);}
.indicators progress::-webkit-progress-bar{background:transparent;}
.indicators progress::-webkit-progress-value{border-radius:var(--indicator-height);}
.progress-bar-buffer::-webkit-progress-value{background:linear-gradient(to right,var(--indicator-buffer-start),var(--indicator-buffer-end)) no-repeat 0 / 100%;}
.progress-bar-duration::-webkit-progress-value{background:linear-gradient(to right,var(--indicator-duration-start),var(--indicator-duration-end)) no-repeat 0 / 100%;}
.progress-bar-buffer::-moz-progress-bar{background:linear-gradient(to right,var(--indicator-buffer-start),var(--indicator-buffer-end)) no-repeat 0 / 100%;}
.progress-bar-duration::-moz-progress-bar{background:linear-gradient(to right,var(--indicator-duration-start),var(--indicator-duration-end)) no-repeat 0 / 100%;}

.actions{height:var(--action-height);display:flex;justify-content:space-between;}
.actions-left,.actions-right{height:inherit;display:flex;}
.actions-right{flex-direction:row-reverse;}
.actions a{position:relative;width:var(--action-height);opacity:.9;transition:opacity 100ms ease;pointer-events:auto;}
.actions a .before,.actions a .after{position:absolute;width:100%;height:100%;left:0;top:0;content:'';background-position:50% 50%;background-size:var(--action-icon-size);background-repeat:no-repeat;display:none;}
.tap .before,.tap .after{animation:tap-act 400ms ease forwards;will-change:transform;}

.tip{position:absolute;top:var(--tip-y);font-size:var(--tip-font-size);color:var(--tip-color);line-height:var(--tip-line-height);background:var(--tip-background);padding:0 8px;border-radius:4px;pointer-events:none;opacity:0;transition:opacity 200ms ease;left:50%;transform:translateX(-50%);}
.tip::after{content:var(--tip-text, '');white-space:nowrap;}

.play-and-pause{width:var(--action-play-width);display:var(--show-on-fullscreen);}
.play-and-pause .before{background-image:var(--ico-play);}
.play-and-pause .after{background-image:var(--ico-pause);}
.play-and-pause[data-mode='play'] .after{display:block;}
.play-and-pause[data-mode='pause'] .before{display:block;}
.play-and-pause[data-mode='play']{--tip-text:var(--tip-pause);}
.play-and-pause[data-mode='pause']{--tip-text:var(--tip-play);}
.play-and-pause .tip{left:0;transform:none;}

.mute-on-and-off{display:var(--show-always);}
.mute-on-and-off .before{background-image:var(--ico-unmute);}
.mute-on-and-off .after{background-image:var(--ico-mute);}
.mute-on-and-off[data-mode='on'] .after{display:block;}
.mute-on-and-off[data-mode='off'] .before{display:block;}
.mute-on-and-off[data-mode='on']{--tip-text:var(--tip-unmute);}
.mute-on-and-off[data-mode='off']{--tip-text:var(--tip-mute);}
.mute-on-and-off .tip{left:0;transform:none;}

.fullscreen-on-and-off{display:var(--show-on-fullscreen);}
.fullscreen-on-and-off .before{background-image:var(--ico-fullscreen);}
.fullscreen-on-and-off .after{background-image:var(--ico-fullscreen-exit);}
.fullscreen-on-and-off[data-mode='on'] .after{display:block;}
.fullscreen-on-and-off[data-mode='off'] .before{display:block;}
.fullscreen-on-and-off[data-mode='on']{--tip-text:var(--tip-fullscreen-exit);}
.fullscreen-on-and-off[data-mode='off']{--tip-text:var(--tip-fullscreen);}
.fullscreen-on-and-off .tip{left:auto;right:0;transform:none;}

.pip-on-and-off{display:var(--show-always);--tip-text:var(--tip-PiP);}
.pip-on-and-off .before{background-image:var(--ico-pip);}
.pip-on-and-off[data-mode='off'] .before{display:block;}
.pip-on-and-off[hidden]{display:none;pointer-events:none;}
.pip-on-and-off .tip{left:auto;right:0;transform:none;}

.reactions{position:absolute;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:1;}
[class|=reaction]{position:absolute;left:0;top:0;right:0;bottom:0;margin:auto;width:var(--reaction-width);height:var(--reaction-width);border-radius:var(--reaction-width);background:var(--ico-reaction) no-repeat 50% 50% / 60% auto,linear-gradient(45deg, var(--reaction-bgc-start), var(--reaction-bgc-end)) no-repeat 50% 50% / 100% 100%;animation:reaction-act 700ms ease forwards;will-change:transform,opacity;text-indent:100%;white-space:nowrap;overflow:hidden;}
.reaction-play{--ico-reaction:var(--ico-play);}
.reaction-pause{--ico-reaction:var(--ico-pause);}
.reaction-mute{--ico-reaction:var(--ico-mute);}
.reaction-unmute{--ico-reaction:var(--ico-unmute);}
.reaction-pip{--ico-reaction:var(--ico-pip);}
.reaction-forward5{--ico-reaction:var(--ico-forward-5);}
.reaction-forward10{--ico-reaction:var(--ico-forward-10);}
.reaction-backward5{--ico-reaction:var(--ico-backward-5);}
.reaction-backward10{--ico-reaction:var(--ico-backward-10);}
.reaction-speed-up-rate{--ico-reaction:var(--ico-speed-up-rate);}
.reaction-speed-down-rate{--ico-reaction:var(--ico-speed-down-rate);}

.playbackrate-info{position:absolute;left:50%;top:50%;font-size:var(--playbackrate-font-size);color:var(--playbackrate-color);content:attr(data-playbackrate);background:var(--playbackrate-background);line-height:var(--playbackrate-line-height);padding:0 .75em;border-radius:4px;pointer-events:none;transform:translate(-50%,-50%);margin-top:var(--playbackrate-margin-top);opacity:0;transition:opacity 300ms ease;will-change:opacity;}
.reaction-speed-up-rate~.playbackrate-info,
.reaction-speed-down-rate~.playbackrate-info{opacity:1;transition-delay:100ms;transition-duration:100ms;}

:host([controls]){--show-on-fullscreen:block;--tip-y:var(--tip-y-progress);}
:host([controls]) .pip-on-and-off .tip{left:50%;right:auto;transform:translateX(-50%);}
:host([controls]) .mute-on-and-off .tip{left:50%;transform:translateX(-50%);}
:host([controls]) .vanquish{display:none;}

.main[data-idle]:not([data-idle=''])::after{position:absolute;left:0;top:0;right:0;bottom:0;margin:auto;content:'';width:var(--reaction-width);height:var(--reaction-width);border-radius:var(--reaction-width);pointer-events:none;background:var(--ico-idle) no-repeat 50% 50% / 60% auto,linear-gradient(45deg, var(--reaction-bgc-start), var(--reaction-bgc-end)) no-repeat 50% 50% / 100% 100%;}
.main[data-idle='play']{--ico-idle:var(--ico-play);}
.main[data-idle='replay']{--ico-idle:var(--ico-replay);--ico-play:var(--ico-replay);}

.error .content{visibility:hidden;pointer-events:none;}
.error::after{position:absolute;top:0;left:0;bottom:0;right:0;margin:auto;font-size:var(--warning-font-size);color:var(--warning-color);width:100%;height:20px;content:var(--warning-text);background:var(--ico-warning) no-repeat 50% 0% / auto 2em;box-sizing:border-box;padding:2.5em 2em 0;text-align:center;}

@keyframes reaction-act{
  0% {transform:scale(.5);opacity:0;}
  30% {opacity:1;}
  100% {transform:scale(1.5);opacity:0;}
}

@keyframes fullscreen-icon-expand{
  0% {transform:scale(1);}
  50% {transform:scale(1.2);}
  100% {transform:scale(1);}
}

@keyframes fullscreen-icon-shrink{
  0% {transform:scale(1);}
  50% {transform:scale(0.8);}
  100% {transform:scale(1);}
}

@keyframes tap-act{
  0% {transform:scale(1);}
  50% {transform:scale(1.3);}
  100% {transform:scale(1);}
}

@keyframes host-focus {
  0% {box-shadow:0 0 0 4px transparent;} 
  3% {box-shadow:0 0 0 4px #8cc4fb;}
  91% {box-shadow:0 0 0 4px #8cc4fb;}
  100% {box-shadow:0 0 0 4px transparent;}
}

@media (hover:hover) {
  .actions a:hover{opacity:1;}
  .actions a:hover .tip{opacity:1;}

  .fullscreen-on-and-off[data-mode='off']:hover .before{animation:fullscreen-icon-expand 400ms ease forwards;}
  .fullscreen-on-and-off[data-mode='on']:hover .after{animation:fullscreen-icon-shrink 400ms ease forwards;}

  .indicators{transition:transform 200ms ease;transform:scaleY(.6);}
  .progress-bar-input::-webkit-slider-thumb{transform:scale(.01);}
  .progress-bar-input::-moz-range-thumb{transform:scale(.01);}

  .progress-bar-wrap:hover .indicators{transform:scaleY(1);}

  .progress-bar-wrap:hover .progress-bar-input::-webkit-slider-thumb{transform:scale(1);}
  .progress-bar-wrap:hover .progress-bar-input:active::-webkit-slider-thumb{transform:scale(1.5);}

  .progress-bar-wrap:hover .progress-bar-input::-moz-range-thumb{transform:scale(1);}
  .progress-bar-wrap:hover .progress-bar-input:active::-moz-range-thumb{transform:scale(1.5);}
}

:host(.fullscreen){position:fixed;left:0;top:0;width:100%;height:100%;z-index:2147483647;border-radius:0 !important;padding:0 !important;margin:0 !important;}
:host(.fullscreen) .main{height:100%;--object-fit:contain;--show-on-normal:none;--show-on-fullscreen:block;--action-height:var(--action-height-fullscreen);--reaction-width:var(--reaction-width-fullscreen);--tip-font-size:var(--tip-font-size-fullscreen);--tip-y:var(--tip-y-fullscreen);--playbackrate-font-size:var(--playbackrate-font-size-fullscreen);}
:host(.fullscreen) .control-pannel{padding-bottom:var(--eb);}
:host(.fullscreen) .pip-on-and-off .tip{left:50%;right:auto;transform:translateX(-50%);}
:host(.fullscreen) .mute-on-and-off .tip{left:50%;transform:translateX(-50%);}

:host(:fullscreen){width:100%;height:100%;}
:host(:fullscreen) .main{height:100%;--object-fit:contain;--show-on-normal:none;--show-on-fullscreen:block;--action-height:var(--action-height-fullscreen);--reaction-width:var(--reaction-width-fullscreen);--tip-font-size:var(--tip-font-size-fullscreen);--tip-y:var(--tip-y-fullscreen);--playbackrate-font-size:var(--playbackrate-font-size-fullscreen);}
:host(:fullscreen) .control-pannel{padding-bottom:var(--eb);}
:host(:fullscreen) .pip-on-and-off .tip{left:50%;right:auto;transform:translateX(-50%);}
:host(:fullscreen) .mute-on-and-off .tip{left:50%;transform:translateX(-50%);}

:host(:-webkit-full-screen){width:100%;height:100%;}
:host(:-webkit-full-screen) .main{height:100%;--object-fit:contain;--show-on-normal:none;--show-on-fullscreen:block;--action-height:var(--action-height-fullscreen);--reaction-width:var(--reaction-width-fullscreen);--tip-font-size:var(--tip-font-size-fullscreen);--tip-y:var(--tip-y-fullscreen);--playbackrate-font-size:var(--playbackrate-font-size-fullscreen);}
:host(:-webkit-full-screen) .control-pannel{padding-bottom:var(--eb);}
:host(:-webkit-full-screen) .pip-on-and-off .tip{left:50%;right:auto;transform:translateX(-50%);}
:host(:-webkit-full-screen) .mute-on-and-off .tip{left:50%;transform:translateX(-50%);}

@supports (bottom:env(safe-area-inset-top)) {
  .main {
    --eb:env(safe-area-inset-bottom);
    --el:env(safe-area-inset-left);
  }
}
</style>

<div class="main" tabindex="0">
  <video
    preload="metadata"
    playsinline
  ></video>
  <div class="control-pannel">
    <div class="progress-bar-wrap">
      <input class="progress-bar-input" type="range" min="0" max="100" step="1" value="0" autocomplete="off" >
      <div class="indicators">
        <progress class="progress-bar-buffer" max="100" value="0"></progress>
        <progress class="progress-bar-duration" max="100" value="0"></progress>
      </div>
    </div>
    <div class="actions">
      <div class="actions-left">
        <a class="play-and-pause" aria-label="play / pause" data-mode="pause">
          <span class="before"></span>
          <span class="after"></span>
          <span class="tip"></span>
        </a>
        <a class="mute-on-and-off" aria-label="on / off" data-mode="on">
          <span class="before"></span>
          <span class="after"></span>
          <span class="tip center"></span>
        </a>
        <p class="time-information">
          <span class="before"></span>
          <span class="after"></span>
          <span class="time-passed">0:00</span> / <span class="time-ended">0:00</span>
        </p>
      </div>
      <div class="actions-right">
        <a class="fullscreen-on-and-off" aria-label="on / off" data-mode="off">
          <span class="before"></span>
          <span class="after"></span>
          <span class="tip right"></span>
        </a>
        <a class="pip-on-and-off" aria-label="on / off" data-mode="off">
          <span class="before"></span>
          <span class="after"></span>
          <span class="tip center"></span>
        </a>
      </div>
    </div>
  </div>
  <div class="reactions">
    <em class="playbackrate-info">1x</em>
  </div>
  <div class="vanquish">
    <input type="range" class="force-focus-factor" />
  </div>
</div>
`,document.createElement("template")),templateReactionPause=(templateReactionPlay.innerHTML=`
  <em class="reaction-play">play</em>
`,document.createElement("template")),templateReactionMute=(templateReactionPause.innerHTML=`
  <em class="reaction-pause">pause</em>
`,document.createElement("template")),templateReactionUnmute=(templateReactionMute.innerHTML=`
  <em class="reaction-mute">mute</em>
`,document.createElement("template")),templateReactionPiP=(templateReactionUnmute.innerHTML=`
  <em class="reaction-unmute">unmute</em>
`,document.createElement("template")),templateReactionForward5=(templateReactionPiP.innerHTML=`
  <em class="reaction-pip">picture in picture</em>
`,document.createElement("template")),templateReactionForward10=(templateReactionForward5.innerHTML=`
  <em class="reaction-forward5">forward 5</em>
`,document.createElement("template")),templateReactionBackward5=(templateReactionForward10.innerHTML=`
  <em class="reaction-forward10">forward 10</em>
`,document.createElement("template")),templateReactionBackward10=(templateReactionBackward5.innerHTML=`
  <em class="reaction-backward5">backward 5</em>
`,document.createElement("template")),templateReactionSpeedUpRate=(templateReactionBackward10.innerHTML=`
  <em class="reaction-backward10">backward 10</em>
`,document.createElement("template")),templateReactionSpeedDownRate=(templateReactionSpeedUpRate.innerHTML=`
  <em class="reaction-speed-up-rate">speed up rate</em>
`,document.createElement("template"));templateReactionSpeedDownRate.innerHTML=`
  <em class="reaction-speed-down-rate">speed doen rate</em>
`;class MscEzVideo extends HTMLElement{#data;#nodes;#config;constructor(e){super(),this.attachShadow({mode:"open",delegatesFocus:!0}),this.shadowRoot.appendChild(template.content.cloneNode(!0)),this.#data={controller:""},this.#nodes={styleSheet:this.shadowRoot.querySelector("style"),ens:this.shadowRoot.querySelector(".main"),video:this.shadowRoot.querySelector("video"),input:this.shadowRoot.querySelector(".progress-bar-input"),barBuffer:this.shadowRoot.querySelector(".progress-bar-buffer"),barDuration:this.shadowRoot.querySelector(".progress-bar-duration"),btnPlay:this.shadowRoot.querySelector(".play-and-pause"),btnMute:this.shadowRoot.querySelector(".mute-on-and-off"),btnPiP:this.shadowRoot.querySelector(".pip-on-and-off"),btnFullscreen:this.shadowRoot.querySelector(".fullscreen-on-and-off"),timePassed:this.shadowRoot.querySelector(".time-passed"),timeEnded:this.shadowRoot.querySelector(".time-ended"),reactions:this.shadowRoot.querySelector(".reactions"),actions:this.shadowRoot.querySelector(".actions"),playbackrate:this.shadowRoot.querySelector(".playbackrate-info")},this.#config={...defaults,...e},this._onLoadeddata=this._onLoadeddata.bind(this),this._onProgress=this._onProgress.bind(this),this._onTimeupdate=this._onTimeupdate.bind(this),this._onPlay=this._onPlay.bind(this),this._onPause=this._onPause.bind(this),this._onEnded=this._onEnded.bind(this),this._onInput=this._onInput.bind(this),this._onClick=this._onClick.bind(this),this._onFullscreenchange=this._onFullscreenchange.bind(this),this._onPiPchange=this._onPiPchange.bind(this),this._onError=this._onError.bind(this),this._onDblclick=this._onDblclick.bind(this),this._onBtnPiPClick=this._onBtnPiPClick.bind(this),this._onBtnPlayClick=this._onBtnPlayClick.bind(this),this._onBtnMuteClick=this._onBtnMuteClick.bind(this),this._onBtnFullscreenClick=this._onBtnFullscreenClick.bind(this),this._onAnimationend=this._onAnimationend.bind(this),this._onTapAnimationend=this._onTapAnimationend.bind(this),this._onRatechange=this._onRatechange.bind(this),this._onContextmenu=this._onContextmenu.bind(this),this._onKeyDown=this._onKeyDown.bind(this)}async connectedCallback(){var{input:e,reactions:t,ens:a,btnPiP:i,btnPlay:n,btnMute:o,btnFullscreen:s,actions:r}=this.#nodes,c=fullscreen["event"],{config:l,error:d}=await _wcl.getWCConfig(this);d?(console.warn(_wcl.classToTagName(this.constructor.name)+": "+d),this.remove()):(this.#config={...this.#config,...l},Object.keys(defaults).forEach(e=>this.#upgradeProperty(e)),this.#data.controller=new AbortController,d=this.#data.controller.signal,(l=this._grabVideoInstance()).addEventListener("progress",this._onProgress,{signal:d}),l.addEventListener("timeupdate",this._onTimeupdate,{signal:d}),l.addEventListener("play",this._onPlay,{signal:d}),l.addEventListener("pause",this._onPause,{signal:d}),l.addEventListener("ended",this._onEnded,{signal:d}),l.addEventListener("loadeddata",this._onLoadeddata,{signal:d}),l.addEventListener("click",this._onClick,{signal:d}),l.addEventListener("error",this._onError,{signal:d}),l.addEventListener("ratechange",this._onRatechange,{signal:d}),a.addEventListener("keydown",this._onKeyDown,{signal:d,capture:!0}),e.addEventListener("input",this._onInput,{signal:d}),n.addEventListener("click",this._onBtnPlayClick,{signal:d}),o.addEventListener("click",this._onBtnMuteClick,{signal:d}),s.addEventListener("click",this._onBtnFullscreenClick,{signal:d}),i.addEventListener("click",this._onBtnPiPClick,{signal:d}),t.addEventListener("animationend",this._onAnimationend,{signal:d}),r.addEventListener("animationend",this._onTapAnimationend,{signal:d}),this.addEventListener("contextmenu",this._onContextmenu,{signal:d}),this.addEventListener("dblclick",this._onDblclick,{signal:d}),c&&this.addEventListener(c,this._onFullscreenchange,{signal:d}),_wcl.isEventSupport("enterpictureinpicture",l)&&(l.addEventListener("enterpictureinpicture",this._onPiPchange,{signal:d}),l.addEventListener("leavepictureinpicture",this._onPiPchange,{signal:d})),PiP||(i.hidden=!0),o.setAttribute("data-mode",this.muted?"on":"off"),this.autoplay||(a.dataset.idle="play"),a.classList.add("active"))}disconnectedCallback(){this.paused||this.pause(),this.PiPed&&this.exitPiP(),this.#data?.controller&&this.#data.controller.abort()}_format(e,t,a){if(null!==a)switch(e){case"width":case"height":_wcl.isNumeric(a)&&(this.#config[e]=parseFloat(a));break;case"loopendtime":this.#config[e]=_wcl.isNumeric(a)?+a:NaN;break;case"title":case"artist":case"src":case"poster":case"crossorigin":this.#config[e]=a;break;case"muted":case"loop":case"autoplay":case"controls":this.#config[e]=!0}else booleanAttrs.includes(e)?this.#config[e]=!1:this.#config[e]=defaults[e]}attributeChangedCallback(e,t,a){var{btnMute:i,ens:n,video:o}=this.#nodes;if(MscEzVideo.observedAttributes.includes(e))switch(this._format(e,t,a),e){case"width":case"height":this._setVars();break;case"title":case"artist":case"poster":case"crossorigin":o[e]=this[e];break;case"src":n.classList.remove("error"),o[e]=this[e];break;case"muted":this.muted?(i.setAttribute("data-mode","on"),n.classList.contains("active")&&this._reaction("mute")):(i.setAttribute("data-mode","off"),n.classList.contains("active")&&this._reaction("unmute"));case"loop":case"autoplay":o[e]=this[e],this[e]?o.setAttribute(e,""):o.removeAttribute(e)}}static get observedAttributes(){return Object.keys(defaults)}static get supportKeyboardKeys(){return legalKey}static get supportedEvents(){return Object.keys(custumEvents).map(e=>custumEvents[e])}#upgradeProperty(e){let t;MscEzVideo.observedAttributes.includes(e)&&(Object.prototype.hasOwnProperty.call(this,e)?(t=this[e],delete this[e]):t=booleanAttrs.includes(e)?!(!this.hasAttribute(e)&&!this.#config[e]):objectAttrs.includes(e)?this.hasAttribute(e)?this.getAttribute(e):JSON.stringify(this.#config[e]):this.hasAttribute(e)?this.getAttribute(e):this.#config[e],this[e]=t)}set width(e){e?this.setAttribute("width",e):this.removeAttribute("width")}get width(){return this.#config.width}set height(e){e?this.setAttribute("height",e):this.removeAttribute("height")}get height(){return this.#config.height}set src(e){e?this.setAttribute("src",e):this.removeAttribute("src")}get src(){return this.#config.src}set poster(e){e?this.setAttribute("poster",e):this.removeAttribute("poster")}get poster(){return this.#config.poster}set crossorigin(e){e?this.setAttribute("crossorigin",e):this.removeAttribute("crossorigin")}get crossorigin(){return this.#config.crossorigin}set title(e){e?this.setAttribute("title",e):this.removeAttribute("title")}get title(){return this.#config.title}set artist(e){e?this.setAttribute("artist",e):this.removeAttribute("artist")}get artist(){return this.#config.artist}set muted(e){e?this.setAttribute("muted",""):this.removeAttribute("muted")}get muted(){return this.#config.muted}set loop(e){e?this.setAttribute("loop",""):this.removeAttribute("loop")}get loop(){return this.#config.loop}set loopendtime(e){e?this.setAttribute("loopendtime",e):this.removeAttribute("loopendtime")}get loopendtime(){return this.#config.loopendtime}get paused(){return this.#nodes.video.paused}set autoplay(e){e?this.setAttribute("autoplay",""):this.removeAttribute("autoplay")}get autoplay(){return this.#config.autoplay}set controls(e){e?this.setAttribute("controls",""):this.removeAttribute("controls")}get controls(){return this.#config.controls}get fullscreened(){var{request:e,element:t}=fullscreen;let a=!1;return a=e?document[t]===this:this.classList.contains("fullscreen")}get PiPed(){var e=this.#nodes["video"];let t=!1;return t=PiP?e.webkitSetPresentationMode?"picture-in-picture"===e.webkitPresentationMode:this===document.pictureInPictureElement:t}async requestPiP(){var e=this.#nodes["video"];if(PiP){this._reaction("pip");try{this.exitFS(),e.webkitSetPresentationMode?(e.webkitSetPresentationMode("picture-in-picture"),this._onPiPchange()):await e.requestPictureInPicture()}catch(e){console.error(_wcl.classToTagName("MscEzVideo")+": "+e.message)}}}async exitPiP(){var e=this.#nodes["video"];if(PiP&&this.PiPed){this._reaction("pip");try{e.webkitSetPresentationMode?(e.webkitSetPresentationMode("inline"),this._onPiPchange()):await document.exitPictureInPicture()}catch(e){console.error(_wcl.classToTagName("MscEzVideo")+": "+e.message)}}}requestFS(){var e=fullscreen["request"],t=this.#nodes["btnFullscreen"];this.exitPiP(),e?this[e]():(this.classList.add("fullscreen"),t.setAttribute("data-mode","on"),this.#fireEvent(custumEvents.fullscreen))}exitFS(){var{request:e,exit:t}=fullscreen,a=this.#nodes["btnFullscreen"];this.fullscreened&&(e?document[t]():(this.classList.remove("fullscreen"),a.setAttribute("data-mode","off"),this.#fireEvent(custumEvents.fullscreen)))}play(){this.#nodes.video.play()}pause(){this.#nodes.video.pause()}#fireEvent(e,t){this.dispatchEvent(new CustomEvent(e,{bubbles:!0,composed:!0,...t&&{detail:t}}))}_onKeyDown(e){var{key:t,preventDefault:a}=e,{video:i,btnMute:n,btnFullscreen:o,btnPiP:s}=this.#nodes,r=fullscreen["request"];let c;if(MscEzVideo.supportKeyboardKeys.includes(t))switch(a&&e.preventDefault(),t){case" ":case"k":i.click();break;case"m":n.click();break;case"Escape":this.fullscreened&&!r&&this.exitFS();break;case"f":o.click();break;case"i":s.click();break;case"j":this.currentTime-=10,this._reaction("backward10");break;case"l":this.currentTime+=10,this._reaction("forward10");break;case"ArrowLeft":this.currentTime-=5,this._reaction("backward5");break;case"ArrowRight":this.currentTime+=5,this._reaction("forward5");break;case"<":(c=this.playbackRate-.25)<minPlaybackRate&&(c=minPlaybackRate),this.playbackRate=c,this._reaction("speeddownrate");break;case">":(c=this.playbackRate+.25)>maxPlaybackRate&&(c=maxPlaybackRate),this.playbackRate=c,this._reaction("speeduprate");break;default:this.currentTime=10*+t/100*this.duration}}get currentTime(){return this.#nodes.video.currentTime||0}set currentTime(e){try{this.#nodes.video.currentTime=e}catch(e){console.error(_wcl.classToTagName("MscEzVideo")+": "+e.message)}}get duration(){return this.#nodes.video.duration||0}get playbackRate(){return this.#nodes.video.playbackRate||1}set playbackRate(e){var t=this["playbackRate"];e>maxPlaybackRate?e=maxPlaybackRate:e<minPlaybackRate&&(e=minPlaybackRate);try{this.#nodes.video.playbackRate=e,this._reaction(t<=e?"speeduprate":"speeddownrate")}catch(e){console.error(_wcl.classToTagName("MscEzVideo")+": "+e.message)}}_timeformat(e){var t=[];let a=Math.floor(e),i=0;return 3600<=a&&(i=Math.floor(a/3600),t.push(i),a%=3600),60<=a?(i=Math.floor(a/60),t.push(i),a%=60):t.push("0"),a?(a<10&&(a="0"+a),t.push(a)):t.push("00"),t.join(":")}_reaction(e){var{reactions:t,btnPlay:a,btnMute:i,btnPiP:n,playbackrate:o}=this.#nodes;let s;switch(e){case"play":s=templateReactionPlay.content.cloneNode(!0),a.classList.add("tap");break;case"pause":s=templateReactionPause.content.cloneNode(!0),a.classList.add("tap");break;case"mute":s=templateReactionMute.content.cloneNode(!0),i.classList.add("tap");break;case"unmute":s=templateReactionUnmute.content.cloneNode(!0),i.classList.add("tap");break;case"pip":s=templateReactionPiP.content.cloneNode(!0),n.classList.add("tap");break;case"forward5":s=templateReactionForward5.content.cloneNode(!0);break;case"forward10":s=templateReactionForward10.content.cloneNode(!0);break;case"backward5":s=templateReactionBackward5.content.cloneNode(!0);break;case"backward10":s=templateReactionBackward10.content.cloneNode(!0);break;case"speeduprate":o.textContent=this.playbackRate+"x",s=templateReactionSpeedUpRate.content.cloneNode(!0);break;case"speeddownrate":o.textContent=this.playbackRate+"x",s=templateReactionSpeedDownRate.content.cloneNode(!0)}t.insertBefore(s,o)}_onLoadeddata(){var e=this.#nodes["timeEnded"];e.textContent=this._timeformat(this.duration),this.#fireEvent(custumEvents.loaded)}_onProgress(){var{barBuffer:t,video:{buffered:a}}=this.#nodes;if(a.length){let e=a.end(a.length-1)/this.duration*100;isNaN(e)&&(e=0),t.value=e}}_onPlay(){var{btnPlay:t,ens:a}=this.#nodes;if(a.dataset.idle="",a.classList.remove("error"),t.setAttribute("data-mode","play"),this._reaction("play"),this.#fireEvent(custumEvents.play),mediaSession){var i,n,{poster:a,title:t,artist:o}=this,s=getAllEzVideo()["length"];let e;e=1<s?[["seekbackward",()=>this._onKeyDown({key:"ArrowLeft"})],["seekforward",()=>this._onKeyDown({key:"ArrowRight"})],["previoustrack",()=>mediaTrackAction(this,"previous")],["nexttrack",()=>mediaTrackAction(this,"next")]]:[["seekbackward",()=>this._onKeyDown({key:"ArrowLeft"})],["seekforward",()=>this._onKeyDown({key:"ArrowRight"})]],navigator.mediaSession.metadata=new window.MediaMetadata({title:t,artist:o,artwork:[{src:a,sizes:"512x512",type:"image/png"}]});for([i,n]of e)try{navigator.mediaSession.setActionHandler(i,n)}catch(e){console.log(`The media session action "${i}" is not supported yet.`)}}}_onPause(){var e=this.#nodes["btnPlay"];e.setAttribute("data-mode","pause"),this._reaction("pause"),this.#fireEvent(custumEvents.pause)}_onEnded(){var e=this.#nodes["ens"];this.paused&&this.duration===this.currentTime&&(e.dataset.idle="replay")}_onTimeupdate(){var{currentTime:e,duration:t}=this,a=this.#nodes["input"];let i=e/t*100;this.loop&&!isNaN(this.loopendtime)&&e>=this.loopendtime?this.currentTime=0:(isNaN(i)&&(i=0),a.value=i,this._updatePassedInfo(),this.#fireEvent(custumEvents.timeupdate))}_onInput(){var{input:{value:e=0}}=this.#nodes,e=this.duration*e/100;this.currentTime=e,this._updatePassedInfo(),this.#fireEvent(custumEvents.seek)}_updatePassedInfo(){var{input:{value:e=0},barDuration:t,timePassed:a}=this.#nodes,i=this.duration*e/100;t.value=e,a.textContent=this._timeformat(i)}_onClick(){this.paused?this.play():this.pause()}_onFullscreenchange(){var e=fullscreen["element"],t=this.#nodes["btnFullscreen"];document[e]?t.setAttribute("data-mode","on"):t.setAttribute("data-mode","off"),this.#fireEvent(custumEvents.fullscreen)}_onPiPchange(){this.#fireEvent(custumEvents.PiP)}_onDblclick(){this.fullscreened?this.exitFS():this.requestFS()}_onBtnPiPClick(e){e.preventDefault(),e.stopPropagation(),PiP&&(this.PiPed?this.exitPiP():this.requestPiP())}_onBtnPlayClick(e){e.preventDefault(),e.stopPropagation(),e.target.classList.add("tap"),this.paused?this.play():this.pause()}_onBtnMuteClick(e){e.preventDefault(),e.stopPropagation(),this.muted=!this.muted,this.#fireEvent(custumEvents.mute)}_onBtnFullscreenClick(e){e.preventDefault(),e.stopPropagation(),this._onDblclick()}_onAnimationend(e){e.target.remove()}_onTapAnimationend(e){var t=e["target"],t=t.closest("a");e.stopPropagation(),t&&t.classList.contains("tap")&&t.classList.remove("tap")}_onContextmenu(e){e.preventDefault()}_onError(){var{video:{error:e},ens:t}=this.#nodes;t.classList.add("error"),this.#fireEvent(custumEvents.error,{error:e})}_onRatechange(){this.#fireEvent(custumEvents.rate)}_grabVideoInstance(){let{video:e,ens:t}=this.#nodes;var a;return _wcl.isIOS&&(this.autoplay||this.muted)&&(a=e.cloneNode(!0),document.body.appendChild(a),t.replaceChild(a,e),e=a,this.#nodes.video=e),e}_setVars(){var{width:e,height:t}=this;_wcl.addStylesheetRules(".active",{"--w":e,"--h":t},this.#nodes.styleSheet)}}const S=_wcl.supports(),T=_wcl.classToTagName("MscEzVideo");S.customElements&&S.shadowDOM&&S.template&&!window.customElements.get(T)&&window.customElements.define(T,MscEzVideo);export{MscEzVideo};